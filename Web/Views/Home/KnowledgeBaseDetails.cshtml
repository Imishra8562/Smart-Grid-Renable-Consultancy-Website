@model Web.Areas.Admin.Model.MasterModel
@using Newtonsoft.Json

@{
    ViewBag.Title = Model.Knowledge_Base_Obj != null ? Model.Knowledge_Base_Obj.Knowledge_Base_Page_Title : "Knowledge Base Details";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section HeadContent {

    <!-- ================= BASIC SEO ================= -->
    <title>@ViewBag.Title</title>

    <meta name="keywords" content="@Model.Knowledge_Base_Obj.Knowledge_Base_Meta_Keyword" />
    <meta name="description" content="@Model.Knowledge_Base_Obj.Knowledge_Base_Meta_Description" />
    <meta name="author" content="Smart Grid Renewable Consultancy" />
    <meta name="robots" content="index, follow" />
    <meta name="news_keywords" content="@Model.Knowledge_Base_Obj.Knowledge_Base_News_Keyword" />
    <!-- ================= CANONICAL ================= -->
    <link rel="canonical" href="https://smartgridrenewable.com/@Model.Knowledge_Base_Obj.Knowledge_Base_Url_Link" />
    <!-- ================= OPEN GRAPH ================= -->
    <meta property="og:type" content="article" />
    <meta property="og:site_name" content="Smart Grid Renewable Consultancy" />
    <meta property="og:url" content="https://smartgridrenewable.com/@Model.Knowledge_Base_Obj.Knowledge_Base_Url_Link" />
    <meta property="og:title" content="@Model.Knowledge_Base_Obj.Knowledge_Base_Og_Title" />
    <meta property="og:description" content="@Model.Knowledge_Base_Obj.Knowledge_Base_Og_Description" />
    <meta property="og:image" content="https://smartgridrenewable.com/Content/assets/images/@Model.Knowledge_Base_Obj.Knowledge_Base_Og_Image" />

    <!-- ================= TWITTER ================= -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="@Model.Knowledge_Base_Obj.Knowledge_Base_Og_Title" />
    <meta name="twitter:description" content="@Model.Knowledge_Base_Obj.Knowledge_Base_Og_Description" />
    <meta name="twitter:image" content="https://smartgridrenewable.com/Content/assets/images/@Model.Knowledge_Base_Obj.Knowledge_Base_Og_Image" />

    <!-- ================= JSON-LD ================= -->
    <script type="application/ld+json">
    @{
        var kb = Model.Knowledge_Base_Obj;

        if (kb != null)
        {
            var cleanDesc = string.IsNullOrEmpty(kb.Knowledge_Base_Description)
                ? ""
                : System.Text.RegularExpressions.Regex.Replace(kb.Knowledge_Base_Description, "<.*?>", "");

            var schema = new Dictionary<string, object>
            {
                { "@context", "https://schema.org" },
                { "@type", "Article" },
                { "headline", kb.Knowledge_Base_Name },
                { "description", cleanDesc },
                { "url", "https://smartgridrenewable.com/" + kb.Knowledge_Base_Url_Link },
                { "image", "https://smartgridrenewable.com/Content/assets/images/" + kb.Knowledge_Base_Og_Image },
                { "author", new Dictionary<string, object>
                    {
                        { "@type", "Organization" },
                        { "name", "Smart Grid Renewable Consultancy" }
                    }
                }
            };

            @Html.Raw(JsonConvert.SerializeObject(schema))
        }
    }
    </script>

    <!-- ===== JSON-LD : BREADCRUMB ===== -->
    <script type="application/ld+json">
    {
      "@@context": "https://schema.org",
      "@@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": "@(Request.Url.Scheme + "://" + Request.Url.Authority)"
        },
        {
          "@@type": "ListItem",
          "position": 2,
          "name": "Industries",
          "item": "@(Request.Url.Scheme + "://" + Request.Url.Authority + "/knowledge-Base")"
        },
        {
          "@@type": "ListItem",
          "position": 3,
          "name": "@Model.Knowledge_Base_Obj.Knowledge_Base_Name",
          "item": "@(Request.Url.Scheme + "://" + Request.Url.Authority + "/knowledge-Base/" + Model.Knowledge_Base_Obj.Knowledge_Base_Url_Link)"
        }
      ]
    }
    </script>
}

<style>
    .icon-circle {
        width: 44px;
        height: 44px;
        border-radius: 50%;
        background-color: #e8f0ff; /* light blue */
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
    }

        .icon-circle i {
            color: #0d6efd; /* Bootstrap primary blue */
            font-size: 18px;
        }
</style>

<section class="page-title" style="position:relative; background-image:url('@Url.Content("~/Content/images/background/8.jpg")'); background-size:cover; background-position:center;">

    <div class="auto-container">
        <div class="content text-white py-5" data-aos="fade-down">
            <h1 class="display-5 fw-bold">
                @Model.Knowledge_Base_Obj.Knowledge_Base_Name
            </h1>
            <ul class="page-breadcrumb list-inline mt-3">

                <li class="list-inline-item">
                    <a href="@Url.Action("Index","Home")" class="text-white text-decoration-none">Home</a>
                </li>
                <li class="list-inline-item text-white">Knowledge Base</li>
            </ul>
        </div>
    </div>
</section>
<!-- ================= CONTENT ================= -->
<section class="py-5 bg-light">
    <div class="container">
        <div class="row g-4">

            <!-- ===== LEFT SIDEBAR : KNOWLEDGE LIST ===== -->
            <div class="col-lg-3">

                <div class="card border-0 shadow-sm">
                    <div class="card-body p-3">

                        <h6 class="fw-bold mb-3 text-uppercase">
                            Knowledge Base
                        </h6>

                        <div class="list-group list-group-flush small">

                            @if (Model.List_Knowledge_Base_Obj != null && Model.List_Knowledge_Base_Obj.Any())
                            {
                                foreach (var item in Model.List_Knowledge_Base_Obj)
                                {
                                    bool isActive = Model.Knowledge_Base_Obj.Knowledge_Base_Id == item.Knowledge_Base_Id;

                                    <a href="@Url.Action("KnowledgeBaseDetails", "Home",new { url = item.Knowledge_Base_Url_Link })" class="list-group-item list-group-item-action @(isActive ? "active bg-warning text-dark fw-semibold border-0" : "")">
                                        @item.Knowledge_Base_Name
                                    </a>
                                }
                            }
                        </div>

                    </div>
                </div>

            </div>

            <!-- ===== CENTER CONTENT ===== -->
            <div class="col-lg-6">

                <div class="card border-0 shadow-sm">
                    <div class="card-body p-4">

                        <span class="badge bg-warning text-dark mb-3">
                            Expert Insight
                        </span>

                        <h2 class="fw-bold mb-4">
                            @Model.Knowledge_Base_Obj.Knowledge_Base_Page_Title
                        </h2>

                        <div class="text-muted lh-lg">
                            @Html.Raw(Model.Knowledge_Base_Obj.Knowledge_Base_Description)
                        </div>

                    </div>
                </div>

            </div>
            <!-- ===== RIGHT IMAGE  other page Link ===== -->
            <div class="col-lg-3">

                <div class="sticky-top" style="top:100px;">

                    <!-- Image -->
                    <img src="@Url.Content(Model.Knowledge_Base_Obj.Knowledge_Base_Image)" class="img-fluid rounded mb-4" alt="@Model.Knowledge_Base_Obj.Knowledge_Base_Image_Alt_Tag" />

                    <!-- engineering-services -->
                    <a href="@Url.Action("EngineeringServicesDetails", "Home", new { url = "power-system-studies" })"
                       class="d-flex align-items-start gap-3 py-3 border-top text-decoration-none text-dark">

                        <div class="icon-circle">
                            <i class="fas fa-cogs"></i>
                        </div>

                        <div>
                            <h6 class="mb-1 fw-semibold text-uppercase">Engineering Services</h6>
                            <p class="mb-0 small text-muted">
                                Expert engineering solutions including power system studies, design analysis,
                                testing, and technical consultancy services.
                            </p>
                        </div>
                    </a>

                    <!--Industries-->
                    <a href="@Url.Action("IndustriesDetail", "Home", new { industries = "Commercial-Industrial" })"
                       class="d-flex align-items-start gap-3 py-3 border-top text-decoration-none text-dark">

                        <div class="icon-circle">
                            <i class="fas fa-industry"></i>
                        </div>

                        <div>
                            <h6 class="mb-1 fw-semibold text-uppercase">Industries</h6>
                            <p class="mb-0 small text-muted">
                                Solutions tailored for commercial, industrial, utility, and infrastructure sectors.
                            </p>
                        </div>
                    </a>
                    <!-- Training -->
                    <a href="@Url.Action("Training", "Home")"
                       class="d-flex align-items-start gap-3 py-3 border-top text-decoration-none text-dark">

                        <div class="icon-circle">
                            <i class="fas fa-user-graduate"></i>
                        </div>

                        <div>
                            <h6 class="mb-1 fw-semibold text-uppercase">Training</h6>
                            <p class="mb-0 small text-muted">
                                Professional training programs to enhance skills and technical expertise.
                            </p>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>
<script type="application/ld+json">
@{
    var kbItem = Model.Knowledge_Base_Obj;
    if (kbItem != null)
    {
        // Remove HTML tags from description
        string descriptionText = string.IsNullOrEmpty(kbItem.Knowledge_Base_Description)? "": System.Text.RegularExpressions.Regex.Replace(kbItem.Knowledge_Base_Description, "<.*?>", "").Trim();

        // Absolute image URL
        string imageUrl = !string.IsNullOrEmpty(kbItem.Knowledge_Base_Image)? Url.Content(kbItem.Knowledge_Base_Image): Url.Content("/Content/images/default-og.png");

        // Absolute URL for the KnowledgeBaseDetails page
        string kbUrl = Url.Action("KnowledgeBaseDetails", "Home", new { url = kbItem.Knowledge_Base_Url_Link }, Request.Url.Scheme);

        var schema = new Dictionary<string, object>
        {
            { "@context", "https://schema.org" },
            { "@type", "Article" },
            { "headline", kbItem.Knowledge_Base_Name ?? "Knowledge Base Article" },
            { "url", kbUrl },
            { "description", descriptionText },
            { "image", imageUrl },
            { "datePublished", kbItem.Created_On },
            { "dateModified", kbItem.Modified_On },
            { "author", new Dictionary<string, object>
                {
                    { "@type", "Organization" },
                    { "name", "Smart Grid Renewable Consultancy" }
                }
            }
        };

        @Html.Raw(JsonConvert.SerializeObject(schema, Formatting.Indented))
    }
}
</script>
